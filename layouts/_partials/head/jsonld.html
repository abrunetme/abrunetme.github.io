{{ $publisher := index site.Data.authors .Site.Params.publisher }}
{{ $publisherSameAs := slice }}
{{ with $publisher.github }}{{ $publisherSameAs = $publisherSameAs | append . }}{{ end }}
{{ with $publisher.linkedin }}{{ $publisherSameAs = $publisherSameAs | append . }}{{ end }}
{{ with $publisher.facebook }}{{ $publisherSameAs = $publisherSameAs | append . }}{{ end }}
{{ with $publisher.website }}{{ $publisherSameAs = $publisherSameAs | append . }}{{ end }}
{{ $publisherUrl := printf "%sauthors/%s.html" .Site.BaseURL $publisher.id }}

{{ $authorId := default .Site.Params.publisher .Params.author }}
{{ $author := index site.Data.authors $authorId }}
{{ $authorSameAs := slice }}
{{ with $author.github }}{{ $authorSameAs = $authorSameAs | append . }}{{ end }}
{{ with $author.linkedin }}{{ $authorSameAs = $authorSameAs | append . }}{{ end }}
{{ with $author.facebook }}{{ $authorSameAs = $authorSameAs | append . }}{{ end }}
{{ with $author.website }}{{ $authorSameAs = $authorSameAs | append . }}{{ end }}
{{ $authorUrl := printf "%sauthors/%s.html" .Site.BaseURL $author.id }}
{{ $publisher := index site.Data.authors .Site.Params.publisher }}
{{ $publisherSameAs := slice }}
{{ with $publisher.github }}{{ $publisherSameAs = $publisherSameAs | append . }}{{ end }}
{{ with $publisher.linkedin }}{{ $publisherSameAs = $publisherSameAs | append . }}{{ end }}
{{ with $publisher.facebook }}{{ $publisherSameAs = $publisherSameAs | append . }}{{ end }}
{{ with $publisher.website }}{{ $publisherSameAs = $publisherSameAs | append . }}{{ end }}
{{ $publisherUrl := printf "%sauthors/%s.html" .Site.BaseURL $publisher.id }}

{{ $authorId := default .Site.Params.publisher .Params.author }}
{{ $author := index site.Data.authors $authorId }}
{{ $authorSameAs := slice }}
{{ with $author.github }}{{ $authorSameAs = $authorSameAs | append . }}{{ end }}
{{ with $author.linkedin }}{{ $authorSameAs = $authorSameAs | append . }}{{ end }}
{{ with $author.facebook }}{{ $authorSameAs = $authorSameAs | append . }}{{ end }}
{{ with $author.website }}{{ $authorSameAs = $authorSameAs | append . }}{{ end }}
{{ $authorUrl := printf "%sauthors/%s.html" .Site.BaseURL $author.id }}

<script type="application/ld+json">
{ 
  "@context": "https://schema.org",
  "@type": "WebSite", 
  "@id": {{ .Site.BaseURL }}, 
  "name": {{ .Site.Title }}, 
  "url": {{ .Site.BaseURL }}, 
  "inLanguage": {{ .Site.Language.Lang | default .Site.LanguageCode }}, 
  "description": {{ .Site.Params.description }}, 
  "publisher": { 
    "@type": "Person",
    "@id": {{ $publisherUrl }}, 
    "name": {{ $publisher.name }}, 
    "url": {{ $publisherUrl }},
    "sameAs": {{ $publisherSameAs }} 
  } 
}
</script>

{{ if eq .Type "posts" }}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "@id": {{ .Permalink }},
  "headline": {{ .Title }},
  "description": {{ .Description | default .Summary | plainify }},
  "url": {{ .Permalink }},
  "author": {
    "@type": "Person",
    "@id": {{ $authorUrl }},
    "name": {{ $author.name }},
    "url": {{ $authorUrl }},
    "sameAs": {{ $authorSameAs }}
  },
  "datePublished": "{{ .PublishDate.Format "2006-01-02T15:04:05Z" }}",
  "dateModified": "{{ .Lastmod.Format "2006-01-02T15:04:05Z" }}",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": {{ .Permalink }}
  }
}
</script>
{{ else }}
{{ $pageURL := cond .IsHome .Site.BaseURL .Permalink }}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebPage",
  "@id": {{ $pageURL }},
  "name": {{ .Title }},
  "description": {{ .Description | default .Site.Params.description }},
  "url": {{ $pageURL }},
  "author": {
    "@type": "Person",
    "@id": {{ $authorUrl }},
    "name": {{ $author.name }},
    "url": {{ $authorUrl }},
    "sameAs": {{ $authorSameAs }}
  },
  "datePublished": "{{ .PublishDate.Format "2006-01-02T15:04:05Z" }}",
  "dateModified": "{{ .Lastmod.Format "2006-01-02T15:04:05Z" }}"
}
</script>
{{ end }}
